{"ast":null,"code":"var _jsxFileName = \"/Users/xuefei/Desktop/calculator00/calculator/renewableCalculator.ui/src/components/steps/ConfigurationComparison.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend } from 'chart.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend);\nconst ConfigurationComparison = ({\n  selectedEquipment,\n  userData,\n  onBack\n}) => {\n  _s();\n  const [availableEquipment, setAvailableEquipment] = useState({});\n  const [configurations, setConfigurations] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showChart, setShowChart] = useState({\n    visible: false,\n    data: null,\n    title: ''\n  });\n  useEffect(() => {\n    loadAvailableEquipment();\n  }, [selectedEquipment]);\n  const loadAvailableEquipment = async () => {\n    try {\n      const promises = [];\n      if (selectedEquipment.solarPanels) {\n        promises.push(fetch('http://localhost:8080/api/equipment/solar-panels/available').then(res => res.json()).then(data => ({\n          type: 'solar',\n          data\n        })));\n      }\n      if (selectedEquipment.heatPump) {\n        promises.push(fetch('http://localhost:8080/api/equipment/heat-pumps/available').then(res => res.json()).then(data => ({\n          type: 'heatPump',\n          data\n        })));\n      }\n      if (selectedEquipment.batteryStorage) {\n        promises.push(fetch('http://localhost:8080/api/equipment/batteries/available').then(res => res.json()).then(data => ({\n          type: 'battery',\n          data\n        })));\n      }\n      const results = await Promise.all(promises);\n      const available = {};\n      results.forEach(result => {\n        available[result.type] = result.data;\n      });\n      setAvailableEquipment(available);\n\n      // Generate 3 recommended configurations\n      const recommendedConfigurations = await generateRecommendedConfigurations(available);\n      setConfigurations(recommendedConfigurations);\n    } catch (error) {\n      console.error('Error loading available equipment:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const generateRecommendedConfigurations = async available => {\n    const configs = [];\n\n    // Configuration 1: Most Cost-Effective (cheapest installation cost)\n    configs.push({\n      id: 1,\n      name: \"💰 Most Cost-Effective\",\n      selections: getCostEffectiveSelections(available),\n      calculations: {\n        installationCost: 0,\n        annualGeneration: 0,\n        annualSavings: 0,\n        annualExportRevenue: 0,\n        annualCO2Savings: 0,\n        paybackPeriod: 0,\n        monthlyData: {\n          generation: new Array(12).fill(0),\n          savings: new Array(12).fill(0),\n          exportRevenue: new Array(12).fill(0),\n          co2Savings: new Array(12).fill(0)\n        }\n      },\n      loading: false\n    });\n\n    // Configuration 2: Most Eco-Friendly (maximum CO2 savings)\n    configs.push({\n      id: 2,\n      name: \"🌱 Most Eco-Friendly\",\n      selections: getEcoFriendlySelections(available),\n      calculations: {\n        installationCost: 0,\n        annualGeneration: 0,\n        annualSavings: 0,\n        annualExportRevenue: 0,\n        annualCO2Savings: 0,\n        paybackPeriod: 0,\n        monthlyData: {\n          generation: new Array(12).fill(0),\n          savings: new Array(12).fill(0),\n          exportRevenue: new Array(12).fill(0),\n          co2Savings: new Array(12).fill(0)\n        }\n      },\n      loading: false\n    });\n\n    // Configuration 3: Balanced Option (best overall value)\n    configs.push({\n      id: 3,\n      name: \"⚖️ Balanced Option\",\n      selections: getBalancedSelections(available),\n      calculations: {\n        installationCost: 0,\n        annualGeneration: 0,\n        annualSavings: 0,\n        annualExportRevenue: 0,\n        annualCO2Savings: 0,\n        paybackPeriod: 0,\n        monthlyData: {\n          generation: new Array(12).fill(0),\n          savings: new Array(12).fill(0),\n          exportRevenue: new Array(12).fill(0),\n          co2Savings: new Array(12).fill(0)\n        }\n      },\n      loading: false\n    });\n\n    // Calculate performance for each configuration\n    for (let config of configs) {\n      if (hasValidSelections(config.selections)) {\n        await calculateConfigurationPerformance(config);\n      }\n    }\n    return configs;\n  };\n  const getCostEffectiveSelections = available => {\n    const selections = {\n      solar: selectedEquipment.solarPanels ? null : null,\n      heatPump: selectedEquipment.heatPump ? null : null,\n      battery: selectedEquipment.batteryStorage ? null : null\n    };\n\n    // Select cheapest options (assuming lower price or basic models)\n    if (selectedEquipment.solarPanels && available.solar && available.solar.length > 0) {\n      // Find the most cost-effective solar panel (lowest price if available, otherwise first option)\n      const cheapestSolar = available.solar.reduce((min, panel) => panel.price && min.price && panel.price < min.price ? panel : min);\n      selections.solar = cheapestSolar.id;\n    }\n    if (selectedEquipment.heatPump && available.heatPump && available.heatPump.length > 0) {\n      // Select most cost-effective heat pump (lowest cost)\n      const cheapestHeatPump = available.heatPump.reduce((min, pump) => pump.cost && min.cost && pump.cost < min.cost ? pump : min);\n      selections.heatPump = cheapestHeatPump.id;\n    }\n    if (selectedEquipment.batteryStorage && available.battery && available.battery.length > 0) {\n      // Select most cost-effective battery (lowest cost)\n      const cheapestBattery = available.battery.reduce((min, battery) => battery.cost && min.cost && battery.cost < min.cost ? battery : min);\n      selections.battery = cheapestBattery.id;\n    }\n    return selections;\n  };\n  const getEcoFriendlySelections = available => {\n    const selections = {\n      solar: selectedEquipment.solarPanels ? null : null,\n      heatPump: selectedEquipment.heatPump ? null : null,\n      battery: selectedEquipment.batteryStorage ? null : null\n    };\n\n    // Select highest efficiency/performance options\n    if (selectedEquipment.solarPanels && available.solar && available.solar.length > 0) {\n      // Find highest efficiency or power solar panel\n      const bestSolar = available.solar.reduce((best, panel) => panel.efficiency && best.efficiency && panel.efficiency > best.efficiency ? panel : panel.ratedPowerPerPanel && best.ratedPowerPerPanel && panel.ratedPowerPerPanel > best.ratedPowerPerPanel ? panel : best);\n      selections.solar = bestSolar.id;\n    }\n    if (selectedEquipment.heatPump && available.heatPump && available.heatPump.length > 0) {\n      // Select highest COP heat pump\n      const bestHeatPump = available.heatPump.reduce((best, pump) => pump.cop && best.cop && pump.cop > best.cop ? pump : best);\n      selections.heatPump = bestHeatPump.id;\n    }\n    if (selectedEquipment.batteryStorage && available.battery && available.battery.length > 0) {\n      // Select largest capacity battery\n      const bestBattery = available.battery.reduce((best, battery) => battery.capacityKwh && best.capacityKwh && battery.capacityKwh > best.capacityKwh ? battery : best);\n      selections.battery = bestBattery.id;\n    }\n    return selections;\n  };\n  const getBalancedSelections = available => {\n    const selections = {\n      solar: selectedEquipment.solarPanels ? null : null,\n      heatPump: selectedEquipment.heatPump ? null : null,\n      battery: selectedEquipment.batteryStorage ? null : null\n    };\n\n    // Select middle-range options (good balance of cost and performance)\n    if (selectedEquipment.solarPanels && available.solar && available.solar.length > 0) {\n      const sortedSolar = [...available.solar].sort((a, b) => (a.price || 0) - (b.price || 0));\n      const middleIndex = Math.floor(sortedSolar.length / 2);\n      selections.solar = sortedSolar[middleIndex].id;\n    }\n    if (selectedEquipment.heatPump && available.heatPump && available.heatPump.length > 0) {\n      const sortedHeatPumps = [...available.heatPump].sort((a, b) => (a.cost || 0) - (b.cost || 0));\n      const middleIndex = Math.floor(sortedHeatPumps.length / 2);\n      selections.heatPump = sortedHeatPumps[middleIndex].id;\n    }\n    if (selectedEquipment.batteryStorage && available.battery && available.battery.length > 0) {\n      const sortedBatteries = [...available.battery].sort((a, b) => (a.cost || 0) - (b.cost || 0));\n      const middleIndex = Math.floor(sortedBatteries.length / 2);\n      selections.battery = sortedBatteries[middleIndex].id;\n    }\n    return selections;\n  };\n  const hasValidSelections = selections => {\n    return Object.values(selections).some(selection => selection !== null && selection !== '');\n  };\n  const calculateConfigurationPerformance = async config => {\n    try {\n      const calculationRequest = {\n        hasSolarPanels: Boolean(selectedEquipment.solarPanels),\n        hasHeatPump: Boolean(selectedEquipment.heatPump),\n        hasBattery: Boolean(selectedEquipment.batteryStorage),\n        solarPanelTypeIds: config.selections.solar ? [Number(config.selections.solar)] : [],\n        heatPumpTypeIds: config.selections.heatPump ? [Number(config.selections.heatPump)] : [],\n        batteryIds: config.selections.battery ? [Number(config.selections.battery)] : [],\n        houseArea: Number(userData.houseArea) || 120,\n        occupants: Number(userData.occupants) || 3,\n        roofArea: Number(userData.roofArea) || 60,\n        // Increased from 30 to 60 sq meters\n        latitude: Number(userData.latitude) || 51.5,\n        longitude: Number(userData.longitude) || -0.1,\n        annualElectricityUsageKwh: Number(userData.annualElectricityUsage) || 3500,\n        annualGasUsageKwh: Number(userData.annualGasUsage) || 18000,\n        monthlyElectricityUsageKwh: Number(userData.monthlyElectricityUsage) || 290,\n        homeOccupancyFactor: Number(userData.homeOccupancyFactor) || 0.6,\n        electricityRate: Number(userData.electricityRate) || 25,\n        // Pence per kWh\n        gasRate: Number(userData.gasRate) || 8,\n        // Pence per kWh\n        exportRate: Number(userData.exportRate) || 15,\n        // Pence per kWh\n        peakElectricityRate: Number(userData.peakElectricityRate) || 35,\n        offPeakElectricityRate: Number(userData.offPeakElectricityRate) || 12,\n        solarInstallationComplexity: Number(userData.solarInstallationComplexity) || 1.2,\n        heatPumpInstallationComplexity: Number(userData.heatPumpInstallationComplexity) || 1.5,\n        batteryInstallationComplexity: Number(userData.batteryInstallationComplexity) || 1.1\n      };\n      console.log('Sending calculation request:', calculationRequest); // Debug log\n\n      const response = await fetch('http://localhost:8080/api/equipment/compare', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(calculationRequest)\n      });\n      if (response.ok) {\n        const result = await response.json();\n        console.log('Received calculation result:', result); // Debug log\n        config.calculations = processCalculationResult(result);\n      } else {\n        const errorText = await response.text();\n        console.error('API response error:', response.status, response.statusText, errorText);\n      }\n    } catch (error) {\n      console.error('Error calculating configuration performance:', error);\n    }\n  };\n  const createEmptyConfiguration = configNumber => ({\n    id: configNumber,\n    name: `Configuration ${configNumber}`,\n    selections: {\n      solar: selectedEquipment.solarPanels ? '' : null,\n      heatPump: selectedEquipment.heatPump ? '' : null,\n      battery: selectedEquipment.batteryStorage ? '' : null\n    },\n    calculations: {\n      installationCost: 0,\n      annualGeneration: 0,\n      annualSavings: 0,\n      annualExportRevenue: 0,\n      annualCO2Savings: 0,\n      paybackPeriod: 0,\n      monthlyData: {\n        generation: new Array(12).fill(0),\n        savings: new Array(12).fill(0),\n        exportRevenue: new Array(12).fill(0),\n        co2Savings: new Array(12).fill(0)\n      }\n    },\n    loading: false\n  });\n  const handleEquipmentChange = async (configId, equipmentType, equipmentId) => {\n    // Update the selection\n    setConfigurations(prev => prev.map(config => {\n      if (config.id === configId) {\n        return {\n          ...config,\n          selections: {\n            ...config.selections,\n            [equipmentType]: equipmentId\n          },\n          loading: true\n        };\n      }\n      return config;\n    }));\n\n    // Recalculate for this configuration\n    await recalculateConfiguration(configId, equipmentType, equipmentId);\n  };\n  const recalculateConfiguration = async (configId, changedEquipmentType, changedEquipmentId) => {\n    try {\n      const config = configurations.find(c => c.id === configId);\n      if (!config) return;\n\n      // Update the changed selection\n      const updatedSelections = {\n        ...config.selections,\n        [changedEquipmentType]: changedEquipmentId\n      };\n\n      // Build request for calculation\n      const calculationRequest = {\n        hasSolarPanels: Boolean(selectedEquipment.solarPanels),\n        hasHeatPump: Boolean(selectedEquipment.heatPump),\n        hasBattery: Boolean(selectedEquipment.batteryStorage),\n        solarPanelTypeIds: updatedSelections.solar ? [Number(updatedSelections.solar)] : [],\n        heatPumpTypeIds: updatedSelections.heatPump ? [Number(updatedSelections.heatPump)] : [],\n        batteryIds: updatedSelections.battery ? [Number(updatedSelections.battery)] : [],\n        houseArea: Number(userData.houseArea) || 120,\n        occupants: Number(userData.occupants) || 3,\n        roofArea: Number(userData.roofArea) || 60,\n        // Increased from 30 to 60 sq meters\n        latitude: Number(userData.latitude) || 51.5,\n        longitude: Number(userData.longitude) || -0.1,\n        annualElectricityUsageKwh: Number(userData.annualElectricityUsage) || 3500,\n        annualGasUsageKwh: Number(userData.annualGasUsage) || 18000,\n        monthlyElectricityUsageKwh: Number(userData.monthlyElectricityUsage) || 290,\n        homeOccupancyFactor: Number(userData.homeOccupancyFactor) || 0.6,\n        electricityRate: Number(userData.electricityRate) || 25,\n        // Pence per kWh\n        gasRate: Number(userData.gasRate) || 8,\n        // Pence per kWh\n        exportRate: Number(userData.exportRate) || 15,\n        // Pence per kWh\n        peakElectricityRate: Number(userData.peakElectricityRate) || 35,\n        offPeakElectricityRate: Number(userData.offPeakElectricityRate) || 12,\n        solarInstallationComplexity: Number(userData.solarInstallationComplexity) || 1.2,\n        heatPumpInstallationComplexity: Number(userData.heatPumpInstallationComplexity) || 1.5,\n        batteryInstallationComplexity: Number(userData.batteryInstallationComplexity) || 1.1\n      };\n      const response = await fetch('http://localhost:8080/api/equipment/compare', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(calculationRequest)\n      });\n      if (response.ok) {\n        const result = await response.json();\n        const calculations = processCalculationResult(result);\n        setConfigurations(prev => prev.map(config => {\n          if (config.id === configId) {\n            return {\n              ...config,\n              selections: updatedSelections,\n              calculations,\n              loading: false\n            };\n          }\n          return config;\n        }));\n      }\n    } catch (error) {\n      console.error('Error recalculating configuration:', error);\n      setConfigurations(prev => prev.map(config => {\n        if (config.id === configId) {\n          return {\n            ...config,\n            loading: false\n          };\n        }\n        return config;\n      }));\n    }\n  };\n  const processCalculationResult = result => {\n    let totalCost = 0;\n    let totalGeneration = 0;\n    let totalSavings = 0;\n    let totalExportRevenue = 0;\n    let totalCO2Savings = 0;\n    const monthlyGeneration = new Array(12).fill(0);\n    const monthlySavings = new Array(12).fill(0);\n    const monthlyExportRevenue = new Array(12).fill(0);\n    const monthlyCO2Savings = new Array(12).fill(0);\n\n    // Aggregate data from all equipment types\n    [...(result.solarPanelOptions || []), ...(result.heatPumpOptions || []), ...(result.batteryOptions || [])].forEach(option => {\n      totalCost += option.installationCost || 0;\n      totalGeneration += option.annualGeneration || 0;\n      totalSavings += option.annualCostSavings || 0;\n      totalExportRevenue += option.annualExportRevenue || 0;\n      totalCO2Savings += option.annualTotalCO2Savings || 0;\n\n      // Aggregate monthly data\n      if (option.monthlyGeneration) {\n        option.monthlyGeneration.forEach((value, index) => {\n          monthlyGeneration[index] += value || 0;\n        });\n      }\n      if (option.monthlyCostSavings) {\n        option.monthlyCostSavings.forEach((value, index) => {\n          monthlySavings[index] += value || 0;\n        });\n      }\n      if (option.monthlyExportRevenue) {\n        option.monthlyExportRevenue.forEach((value, index) => {\n          monthlyExportRevenue[index] += value || 0;\n        });\n      }\n      if (option.monthlyDirectCO2Savings && option.monthlyIndirectCO2Savings) {\n        option.monthlyDirectCO2Savings.forEach((direct, index) => {\n          const indirect = option.monthlyIndirectCO2Savings[index] || 0;\n          monthlyCO2Savings[index] += (direct || 0) + indirect;\n        });\n      }\n    });\n    const paybackPeriod = totalSavings + totalExportRevenue > 0 ? totalCost / (totalSavings + totalExportRevenue) : 999;\n    return {\n      installationCost: totalCost,\n      annualGeneration: totalGeneration,\n      annualSavings: totalSavings,\n      annualExportRevenue: totalExportRevenue,\n      annualCO2Savings: totalCO2Savings,\n      paybackPeriod: paybackPeriod,\n      monthlyData: {\n        generation: monthlyGeneration,\n        savings: monthlySavings,\n        exportRevenue: monthlyExportRevenue,\n        co2Savings: monthlyCO2Savings\n      }\n    };\n  };\n  const addConfiguration = () => {\n    const newId = Math.max(...configurations.map(c => c.id)) + 1;\n    setConfigurations(prev => [...prev, createEmptyConfiguration(newId)]);\n  };\n  const removeConfiguration = configId => {\n    if (configurations.length > 1) {\n      setConfigurations(prev => prev.filter(c => c.id !== configId));\n    }\n  };\n  const showMonthlyChart = (config, dataType, title) => {\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    let monthlyData = [];\n    switch (dataType) {\n      case 'generation':\n        monthlyData = config.calculations.monthlyData.generation;\n        break;\n      case 'savings':\n        monthlyData = config.calculations.monthlyData.savings;\n        break;\n      case 'exportRevenue':\n        monthlyData = config.calculations.monthlyData.exportRevenue;\n        break;\n      case 'co2Savings':\n        monthlyData = config.calculations.monthlyData.co2Savings;\n        break;\n      default:\n        monthlyData = [];\n    }\n    const chartData = {\n      labels: months,\n      datasets: [{\n        label: title,\n        data: monthlyData,\n        borderColor: getChartColor(dataType),\n        backgroundColor: getChartColor(dataType) + '20',\n        tension: 0.4,\n        fill: true\n      }]\n    };\n    const chartOptions = {\n      responsive: true,\n      plugins: {\n        legend: {\n          position: 'top'\n        },\n        title: {\n          display: true,\n          text: `${config.name} - ${title}`\n        }\n      },\n      scales: {\n        y: {\n          beginAtZero: true\n        }\n      }\n    };\n    setShowChart({\n      visible: true,\n      data: chartData,\n      options: chartOptions,\n      title: `${config.name} - ${title}`\n    });\n  };\n  const getChartColor = dataType => {\n    const colors = {\n      generation: '#3498db',\n      savings: '#27ae60',\n      exportRevenue: '#f39c12',\n      co2Savings: '#e74c3c'\n    };\n    return colors[dataType] || '#34495e';\n  };\n  const formatCurrency = value => {\n    return value ? `£${Math.round(value).toLocaleString()}` : '£0';\n  };\n  const formatNumber = (value, unit = '') => {\n    return value ? `${Math.round(value).toLocaleString()}${unit}` : `0${unit}`;\n  };\n  const getEquipmentName = (equipmentType, equipmentId) => {\n    if (!equipmentId || !availableEquipment[equipmentType]) return '';\n    const equipment = availableEquipment[equipmentType].find(e => e.id == equipmentId);\n    return equipment ? equipment.name : '';\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"configuration-comparison-loading\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Loading Equipment Options...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 589,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Generating recommended configurations for you.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"configuration-comparison\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comparison-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"System Configuration Comparison\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Here are our recommended configurations. You can modify them or add your own.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 599,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"configuration-table-container\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"configuration-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Configuration Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 606,\n              columnNumber: 15\n            }, this), selectedEquipment.solarPanels && /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Solar Panels\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 607,\n              columnNumber: 49\n            }, this), selectedEquipment.heatPump && /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Heat Pump\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 46\n            }, this), selectedEquipment.batteryStorage && /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Battery Storage\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 609,\n              columnNumber: 52\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Installation Cost\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 610,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"clickable-header\",\n              title: \"Click to view monthly chart\",\n              children: \"Annual Generation\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 611,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"clickable-header\",\n              title: \"Click to view monthly chart\",\n              children: \"Annual Savings\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"clickable-header\",\n              title: \"Click to view monthly chart\",\n              children: \"Export Revenue\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 613,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"clickable-header\",\n              title: \"Click to view monthly chart\",\n              children: \"CO\\u2082 Savings\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 614,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Payback Period\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 615,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Actions\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 605,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: configurations.map(config => {\n            var _availableEquipment$s, _availableEquipment$h, _availableEquipment$b;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: config.loading ? 'loading-row' : '',\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: config.name,\n                  onChange: e => {\n                    setConfigurations(prev => prev.map(c => c.id === config.id ? {\n                      ...c,\n                      name: e.target.value\n                    } : c));\n                  },\n                  className: \"config-name-input\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 623,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 622,\n                columnNumber: 17\n              }, this), selectedEquipment.solarPanels && /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: config.selections.solar || '',\n                  onChange: e => handleEquipmentChange(config.id, 'solar', e.target.value),\n                  className: \"equipment-select\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Please select...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 642,\n                    columnNumber: 23\n                  }, this), (_availableEquipment$s = availableEquipment.solar) === null || _availableEquipment$s === void 0 ? void 0 : _availableEquipment$s.map(panel => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: panel.id,\n                    children: [panel.name, \" (\", panel.ratedPowerPerPanel, \"W)\"]\n                  }, panel.id, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 644,\n                    columnNumber: 25\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 637,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 636,\n                columnNumber: 19\n              }, this), selectedEquipment.heatPump && /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: config.selections.heatPump || '',\n                  onChange: e => handleEquipmentChange(config.id, 'heatPump', e.target.value),\n                  className: \"equipment-select\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Please select...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 659,\n                    columnNumber: 23\n                  }, this), (_availableEquipment$h = availableEquipment.heatPump) === null || _availableEquipment$h === void 0 ? void 0 : _availableEquipment$h.map(heatPump => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: heatPump.id,\n                    children: [heatPump.name, \" (COP: \", heatPump.cop, \")\"]\n                  }, heatPump.id, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 661,\n                    columnNumber: 25\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 654,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 653,\n                columnNumber: 19\n              }, this), selectedEquipment.batteryStorage && /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: config.selections.battery || '',\n                  onChange: e => handleEquipmentChange(config.id, 'battery', e.target.value),\n                  className: \"equipment-select\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Please select...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 676,\n                    columnNumber: 23\n                  }, this), (_availableEquipment$b = availableEquipment.battery) === null || _availableEquipment$b === void 0 ? void 0 : _availableEquipment$b.map(battery => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: battery.id,\n                    children: [battery.name, \" (\", battery.capacityKwh, \"kWh)\"]\n                  }, battery.id, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 678,\n                    columnNumber: 25\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 671,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 670,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: config.loading ? 'Calculating...' : formatCurrency(config.calculations.installationCost)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 686,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"clickable-cell\",\n                onClick: () => !config.loading && showMonthlyChart(config, 'generation', 'Monthly Generation (kWh)'),\n                children: config.loading ? 'Calculating...' : formatNumber(config.calculations.annualGeneration, ' kWh')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 688,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"clickable-cell\",\n                onClick: () => !config.loading && showMonthlyChart(config, 'savings', 'Monthly Savings (£)'),\n                children: config.loading ? 'Calculating...' : formatCurrency(config.calculations.annualSavings)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 695,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"clickable-cell\",\n                onClick: () => !config.loading && showMonthlyChart(config, 'exportRevenue', 'Monthly Export Revenue (£)'),\n                children: config.loading ? 'Calculating...' : formatCurrency(config.calculations.annualExportRevenue)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 702,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"clickable-cell\",\n                onClick: () => !config.loading && showMonthlyChart(config, 'co2Savings', 'Monthly CO₂ Savings (kg)'),\n                children: config.loading ? 'Calculating...' : formatNumber(config.calculations.annualCO2Savings, ' kg')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 709,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: config.loading ? 'Calculating...' : formatNumber(config.calculations.paybackPeriod, ' years')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 716,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-remove\",\n                  onClick: () => removeConfiguration(config.id),\n                  disabled: configurations.length <= 1,\n                  title: \"Remove configuration\",\n                  children: \"\\xD7\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 719,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 718,\n                columnNumber: 17\n              }, this)]\n            }, config.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 621,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 603,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 602,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-secondary\",\n        onClick: addConfiguration,\n        children: \"+ Add Custom Configuration\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 735,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"table-hint\",\n        children: \"\\uD83D\\uDCA1 The first 3 are our recommendations. Modify them or add your own configurations.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 738,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 734,\n      columnNumber: 7\n    }, this), showChart.visible && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-modal-overlay\",\n      onClick: () => setShowChart({\n        visible: false,\n        data: null,\n        title: ''\n      }),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-modal\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chart-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: showChart.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 748,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"chart-close-button\",\n            onClick: () => setShowChart({\n              visible: false,\n              data: null,\n              title: ''\n            }),\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 747,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chart-container\",\n          children: /*#__PURE__*/_jsxDEV(Line, {\n            data: showChart.data,\n            options: showChart.options\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 757,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 756,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 746,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 745,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comparison-actions\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-secondary\",\n        onClick: onBack,\n        children: \"Back to Equipment Selection\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 764,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 763,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 596,\n    columnNumber: 5\n  }, this);\n};\n_s(ConfigurationComparison, \"5Lz1cmPciLa3B07XiDMOj8qfg5Y=\");\n_c = ConfigurationComparison;\nexport default ConfigurationComparison;\nvar _c;\n$RefreshReg$(_c, \"ConfigurationComparison\");","map":{"version":3,"names":["React","useState","useEffect","Line","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","jsxDEV","_jsxDEV","register","ConfigurationComparison","selectedEquipment","userData","onBack","_s","availableEquipment","setAvailableEquipment","configurations","setConfigurations","loading","setLoading","showChart","setShowChart","visible","data","title","loadAvailableEquipment","promises","solarPanels","push","fetch","then","res","json","type","heatPump","batteryStorage","results","Promise","all","available","forEach","result","recommendedConfigurations","generateRecommendedConfigurations","error","console","configs","id","name","selections","getCostEffectiveSelections","calculations","installationCost","annualGeneration","annualSavings","annualExportRevenue","annualCO2Savings","paybackPeriod","monthlyData","generation","Array","fill","savings","exportRevenue","co2Savings","getEcoFriendlySelections","getBalancedSelections","config","hasValidSelections","calculateConfigurationPerformance","solar","battery","length","cheapestSolar","reduce","min","panel","price","cheapestHeatPump","pump","cost","cheapestBattery","bestSolar","best","efficiency","ratedPowerPerPanel","bestHeatPump","cop","bestBattery","capacityKwh","sortedSolar","sort","a","b","middleIndex","Math","floor","sortedHeatPumps","sortedBatteries","Object","values","some","selection","calculationRequest","hasSolarPanels","Boolean","hasHeatPump","hasBattery","solarPanelTypeIds","Number","heatPumpTypeIds","batteryIds","houseArea","occupants","roofArea","latitude","longitude","annualElectricityUsageKwh","annualElectricityUsage","annualGasUsageKwh","annualGasUsage","monthlyElectricityUsageKwh","monthlyElectricityUsage","homeOccupancyFactor","electricityRate","gasRate","exportRate","peakElectricityRate","offPeakElectricityRate","solarInstallationComplexity","heatPumpInstallationComplexity","batteryInstallationComplexity","log","response","method","headers","body","JSON","stringify","ok","processCalculationResult","errorText","text","status","statusText","createEmptyConfiguration","configNumber","handleEquipmentChange","configId","equipmentType","equipmentId","prev","map","recalculateConfiguration","changedEquipmentType","changedEquipmentId","find","c","updatedSelections","totalCost","totalGeneration","totalSavings","totalExportRevenue","totalCO2Savings","monthlyGeneration","monthlySavings","monthlyExportRevenue","monthlyCO2Savings","solarPanelOptions","heatPumpOptions","batteryOptions","option","annualCostSavings","annualTotalCO2Savings","value","index","monthlyCostSavings","monthlyDirectCO2Savings","monthlyIndirectCO2Savings","direct","indirect","addConfiguration","newId","max","removeConfiguration","filter","showMonthlyChart","dataType","months","chartData","labels","datasets","label","borderColor","getChartColor","backgroundColor","tension","chartOptions","responsive","plugins","legend","position","display","scales","y","beginAtZero","options","colors","formatCurrency","round","toLocaleString","formatNumber","unit","getEquipmentName","equipment","e","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_availableEquipment$s","_availableEquipment$h","_availableEquipment$b","onChange","target","onClick","disabled","stopPropagation","_c","$RefreshReg$"],"sources":["/Users/xuefei/Desktop/calculator00/calculator/renewableCalculator.ui/src/components/steps/ConfigurationComparison.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n} from 'chart.js';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\nconst ConfigurationComparison = ({ selectedEquipment, userData, onBack }) => {\n  const [availableEquipment, setAvailableEquipment] = useState({});\n  const [configurations, setConfigurations] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showChart, setShowChart] = useState({ visible: false, data: null, title: '' });\n\n  useEffect(() => {\n    loadAvailableEquipment();\n  }, [selectedEquipment]);\n\n  const loadAvailableEquipment = async () => {\n    try {\n      const promises = [];\n      \n      if (selectedEquipment.solarPanels) {\n        promises.push(\n          fetch('http://localhost:8080/api/equipment/solar-panels/available')\n            .then(res => res.json())\n            .then(data => ({ type: 'solar', data }))\n        );\n      }\n      \n      if (selectedEquipment.heatPump) {\n        promises.push(\n          fetch('http://localhost:8080/api/equipment/heat-pumps/available')\n            .then(res => res.json())\n            .then(data => ({ type: 'heatPump', data }))\n        );\n      }\n      \n      if (selectedEquipment.batteryStorage) {\n        promises.push(\n          fetch('http://localhost:8080/api/equipment/batteries/available')\n            .then(res => res.json())\n            .then(data => ({ type: 'battery', data }))\n        );\n      }\n\n      const results = await Promise.all(promises);\n      \n      const available = {};\n      results.forEach(result => {\n        available[result.type] = result.data;\n      });\n      \n      setAvailableEquipment(available);\n      \n      // Generate 3 recommended configurations\n      const recommendedConfigurations = await generateRecommendedConfigurations(available);\n      setConfigurations(recommendedConfigurations);\n      \n    } catch (error) {\n      console.error('Error loading available equipment:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const generateRecommendedConfigurations = async (available) => {\n    const configs = [];\n    \n    // Configuration 1: Most Cost-Effective (cheapest installation cost)\n    configs.push({\n      id: 1,\n      name: \"💰 Most Cost-Effective\",\n      selections: getCostEffectiveSelections(available),\n      calculations: {\n        installationCost: 0,\n        annualGeneration: 0,\n        annualSavings: 0,\n        annualExportRevenue: 0,\n        annualCO2Savings: 0,\n        paybackPeriod: 0,\n        monthlyData: {\n          generation: new Array(12).fill(0),\n          savings: new Array(12).fill(0),\n          exportRevenue: new Array(12).fill(0),\n          co2Savings: new Array(12).fill(0)\n        }\n      },\n      loading: false\n    });\n\n    // Configuration 2: Most Eco-Friendly (maximum CO2 savings)\n    configs.push({\n      id: 2,\n      name: \"🌱 Most Eco-Friendly\",\n      selections: getEcoFriendlySelections(available),\n      calculations: {\n        installationCost: 0,\n        annualGeneration: 0,\n        annualSavings: 0,\n        annualExportRevenue: 0,\n        annualCO2Savings: 0,\n        paybackPeriod: 0,\n        monthlyData: {\n          generation: new Array(12).fill(0),\n          savings: new Array(12).fill(0),\n          exportRevenue: new Array(12).fill(0),\n          co2Savings: new Array(12).fill(0)\n        }\n      },\n      loading: false\n    });\n\n    // Configuration 3: Balanced Option (best overall value)\n    configs.push({\n      id: 3,\n      name: \"⚖️ Balanced Option\",\n      selections: getBalancedSelections(available),\n      calculations: {\n        installationCost: 0,\n        annualGeneration: 0,\n        annualSavings: 0,\n        annualExportRevenue: 0,\n        annualCO2Savings: 0,\n        paybackPeriod: 0,\n        monthlyData: {\n          generation: new Array(12).fill(0),\n          savings: new Array(12).fill(0),\n          exportRevenue: new Array(12).fill(0),\n          co2Savings: new Array(12).fill(0)\n        }\n      },\n      loading: false\n    });\n\n    // Calculate performance for each configuration\n    for (let config of configs) {\n      if (hasValidSelections(config.selections)) {\n        await calculateConfigurationPerformance(config);\n      }\n    }\n\n    return configs;\n  };\n\n  const getCostEffectiveSelections = (available) => {\n    const selections = {\n      solar: selectedEquipment.solarPanels ? null : null,\n      heatPump: selectedEquipment.heatPump ? null : null,\n      battery: selectedEquipment.batteryStorage ? null : null,\n    };\n\n    // Select cheapest options (assuming lower price or basic models)\n    if (selectedEquipment.solarPanels && available.solar && available.solar.length > 0) {\n      // Find the most cost-effective solar panel (lowest price if available, otherwise first option)\n      const cheapestSolar = available.solar.reduce((min, panel) => \n        (panel.price && min.price && panel.price < min.price) ? panel : min\n      );\n      selections.solar = cheapestSolar.id;\n    }\n\n    if (selectedEquipment.heatPump && available.heatPump && available.heatPump.length > 0) {\n      // Select most cost-effective heat pump (lowest cost)\n      const cheapestHeatPump = available.heatPump.reduce((min, pump) => \n        (pump.cost && min.cost && pump.cost < min.cost) ? pump : min\n      );\n      selections.heatPump = cheapestHeatPump.id;\n    }\n\n    if (selectedEquipment.batteryStorage && available.battery && available.battery.length > 0) {\n      // Select most cost-effective battery (lowest cost)\n      const cheapestBattery = available.battery.reduce((min, battery) => \n        (battery.cost && min.cost && battery.cost < min.cost) ? battery : min\n      );\n      selections.battery = cheapestBattery.id;\n    }\n\n    return selections;\n  };\n\n  const getEcoFriendlySelections = (available) => {\n    const selections = {\n      solar: selectedEquipment.solarPanels ? null : null,\n      heatPump: selectedEquipment.heatPump ? null : null,\n      battery: selectedEquipment.batteryStorage ? null : null,\n    };\n\n    // Select highest efficiency/performance options\n    if (selectedEquipment.solarPanels && available.solar && available.solar.length > 0) {\n      // Find highest efficiency or power solar panel\n      const bestSolar = available.solar.reduce((best, panel) => \n        (panel.efficiency && best.efficiency && panel.efficiency > best.efficiency) ? panel : \n        (panel.ratedPowerPerPanel && best.ratedPowerPerPanel && panel.ratedPowerPerPanel > best.ratedPowerPerPanel) ? panel : best\n      );\n      selections.solar = bestSolar.id;\n    }\n\n    if (selectedEquipment.heatPump && available.heatPump && available.heatPump.length > 0) {\n      // Select highest COP heat pump\n      const bestHeatPump = available.heatPump.reduce((best, pump) => \n        (pump.cop && best.cop && pump.cop > best.cop) ? pump : best\n      );\n      selections.heatPump = bestHeatPump.id;\n    }\n\n    if (selectedEquipment.batteryStorage && available.battery && available.battery.length > 0) {\n      // Select largest capacity battery\n      const bestBattery = available.battery.reduce((best, battery) => \n        (battery.capacityKwh && best.capacityKwh && battery.capacityKwh > best.capacityKwh) ? battery : best\n      );\n      selections.battery = bestBattery.id;\n    }\n\n    return selections;\n  };\n\n  const getBalancedSelections = (available) => {\n    const selections = {\n      solar: selectedEquipment.solarPanels ? null : null,\n      heatPump: selectedEquipment.heatPump ? null : null,\n      battery: selectedEquipment.batteryStorage ? null : null,\n    };\n\n    // Select middle-range options (good balance of cost and performance)\n    if (selectedEquipment.solarPanels && available.solar && available.solar.length > 0) {\n      const sortedSolar = [...available.solar].sort((a, b) => \n        (a.price || 0) - (b.price || 0)\n      );\n      const middleIndex = Math.floor(sortedSolar.length / 2);\n      selections.solar = sortedSolar[middleIndex].id;\n    }\n\n    if (selectedEquipment.heatPump && available.heatPump && available.heatPump.length > 0) {\n      const sortedHeatPumps = [...available.heatPump].sort((a, b) => \n        (a.cost || 0) - (b.cost || 0)\n      );\n      const middleIndex = Math.floor(sortedHeatPumps.length / 2);\n      selections.heatPump = sortedHeatPumps[middleIndex].id;\n    }\n\n    if (selectedEquipment.batteryStorage && available.battery && available.battery.length > 0) {\n      const sortedBatteries = [...available.battery].sort((a, b) => \n        (a.cost || 0) - (b.cost || 0)\n      );\n      const middleIndex = Math.floor(sortedBatteries.length / 2);\n      selections.battery = sortedBatteries[middleIndex].id;\n    }\n\n    return selections;\n  };\n\n  const hasValidSelections = (selections) => {\n    return Object.values(selections).some(selection => selection !== null && selection !== '');\n  };\n\n  const calculateConfigurationPerformance = async (config) => {\n    try {\n      const calculationRequest = {\n        hasSolarPanels: Boolean(selectedEquipment.solarPanels),\n        hasHeatPump: Boolean(selectedEquipment.heatPump),\n        hasBattery: Boolean(selectedEquipment.batteryStorage),\n        solarPanelTypeIds: config.selections.solar ? [Number(config.selections.solar)] : [],\n        heatPumpTypeIds: config.selections.heatPump ? [Number(config.selections.heatPump)] : [],\n        batteryIds: config.selections.battery ? [Number(config.selections.battery)] : [],\n        houseArea: Number(userData.houseArea) || 120,\n        occupants: Number(userData.occupants) || 3,\n        roofArea: Number(userData.roofArea) || 60,  // Increased from 30 to 60 sq meters\n        latitude: Number(userData.latitude) || 51.5,\n        longitude: Number(userData.longitude) || -0.1,\n        annualElectricityUsageKwh: Number(userData.annualElectricityUsage) || 3500,\n        annualGasUsageKwh: Number(userData.annualGasUsage) || 18000,\n        monthlyElectricityUsageKwh: Number(userData.monthlyElectricityUsage) || 290,\n        homeOccupancyFactor: Number(userData.homeOccupancyFactor) || 0.6,\n        electricityRate: Number(userData.electricityRate) || 25,  // Pence per kWh\n        gasRate: Number(userData.gasRate) || 8,     // Pence per kWh\n        exportRate: Number(userData.exportRate) || 15,  // Pence per kWh\n        peakElectricityRate: Number(userData.peakElectricityRate) || 35,\n        offPeakElectricityRate: Number(userData.offPeakElectricityRate) || 12,\n        solarInstallationComplexity: Number(userData.solarInstallationComplexity) || 1.2,\n        heatPumpInstallationComplexity: Number(userData.heatPumpInstallationComplexity) || 1.5,\n        batteryInstallationComplexity: Number(userData.batteryInstallationComplexity) || 1.1,\n      };\n\n      console.log('Sending calculation request:', calculationRequest); // Debug log\n\n      const response = await fetch('http://localhost:8080/api/equipment/compare', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(calculationRequest)\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        console.log('Received calculation result:', result); // Debug log\n        config.calculations = processCalculationResult(result);\n      } else {\n        const errorText = await response.text();\n        console.error('API response error:', response.status, response.statusText, errorText);\n      }\n    } catch (error) {\n      console.error('Error calculating configuration performance:', error);\n    }\n  };\n\n  const createEmptyConfiguration = (configNumber) => ({\n    id: configNumber,\n    name: `Configuration ${configNumber}`,\n    selections: {\n      solar: selectedEquipment.solarPanels ? '' : null,\n      heatPump: selectedEquipment.heatPump ? '' : null,\n      battery: selectedEquipment.batteryStorage ? '' : null,\n    },\n    calculations: {\n      installationCost: 0,\n      annualGeneration: 0,\n      annualSavings: 0,\n      annualExportRevenue: 0,\n      annualCO2Savings: 0,\n      paybackPeriod: 0,\n      monthlyData: {\n        generation: new Array(12).fill(0),\n        savings: new Array(12).fill(0),\n        exportRevenue: new Array(12).fill(0),\n        co2Savings: new Array(12).fill(0)\n      }\n    },\n    loading: false\n  });\n\n  const handleEquipmentChange = async (configId, equipmentType, equipmentId) => {\n    // Update the selection\n    setConfigurations(prev => prev.map(config => {\n      if (config.id === configId) {\n        return {\n          ...config,\n          selections: {\n            ...config.selections,\n            [equipmentType]: equipmentId\n          },\n          loading: true\n        };\n      }\n      return config;\n    }));\n\n    // Recalculate for this configuration\n    await recalculateConfiguration(configId, equipmentType, equipmentId);\n  };\n\n  const recalculateConfiguration = async (configId, changedEquipmentType, changedEquipmentId) => {\n    try {\n      const config = configurations.find(c => c.id === configId);\n      if (!config) return;\n\n      // Update the changed selection\n      const updatedSelections = {\n        ...config.selections,\n        [changedEquipmentType]: changedEquipmentId\n      };\n\n      // Build request for calculation\n      const calculationRequest = {\n        hasSolarPanels: Boolean(selectedEquipment.solarPanels),\n        hasHeatPump: Boolean(selectedEquipment.heatPump),\n        hasBattery: Boolean(selectedEquipment.batteryStorage),\n        solarPanelTypeIds: updatedSelections.solar ? [Number(updatedSelections.solar)] : [],\n        heatPumpTypeIds: updatedSelections.heatPump ? [Number(updatedSelections.heatPump)] : [],\n        batteryIds: updatedSelections.battery ? [Number(updatedSelections.battery)] : [],\n        houseArea: Number(userData.houseArea) || 120,\n        occupants: Number(userData.occupants) || 3,\n        roofArea: Number(userData.roofArea) || 60,  // Increased from 30 to 60 sq meters\n        latitude: Number(userData.latitude) || 51.5,\n        longitude: Number(userData.longitude) || -0.1,\n        annualElectricityUsageKwh: Number(userData.annualElectricityUsage) || 3500,\n        annualGasUsageKwh: Number(userData.annualGasUsage) || 18000,\n        monthlyElectricityUsageKwh: Number(userData.monthlyElectricityUsage) || 290,\n        homeOccupancyFactor: Number(userData.homeOccupancyFactor) || 0.6,\n        electricityRate: Number(userData.electricityRate) || 25,  // Pence per kWh\n        gasRate: Number(userData.gasRate) || 8,     // Pence per kWh\n        exportRate: Number(userData.exportRate) || 15,  // Pence per kWh\n        peakElectricityRate: Number(userData.peakElectricityRate) || 35,\n        offPeakElectricityRate: Number(userData.offPeakElectricityRate) || 12,\n        solarInstallationComplexity: Number(userData.solarInstallationComplexity) || 1.2,\n        heatPumpInstallationComplexity: Number(userData.heatPumpInstallationComplexity) || 1.5,\n        batteryInstallationComplexity: Number(userData.batteryInstallationComplexity) || 1.1,\n      };\n\n      const response = await fetch('http://localhost:8080/api/equipment/compare', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(calculationRequest)\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        const calculations = processCalculationResult(result);\n        \n        setConfigurations(prev => prev.map(config => {\n          if (config.id === configId) {\n            return {\n              ...config,\n              selections: updatedSelections,\n              calculations,\n              loading: false\n            };\n          }\n          return config;\n        }));\n      }\n    } catch (error) {\n      console.error('Error recalculating configuration:', error);\n      setConfigurations(prev => prev.map(config => {\n        if (config.id === configId) {\n          return { ...config, loading: false };\n        }\n        return config;\n      }));\n    }\n  };\n\n  const processCalculationResult = (result) => {\n    let totalCost = 0;\n    let totalGeneration = 0;\n    let totalSavings = 0;\n    let totalExportRevenue = 0;\n    let totalCO2Savings = 0;\n    const monthlyGeneration = new Array(12).fill(0);\n    const monthlySavings = new Array(12).fill(0);\n    const monthlyExportRevenue = new Array(12).fill(0);\n    const monthlyCO2Savings = new Array(12).fill(0);\n\n    // Aggregate data from all equipment types\n    [...(result.solarPanelOptions || []), ...(result.heatPumpOptions || []), ...(result.batteryOptions || [])].forEach(option => {\n      totalCost += option.installationCost || 0;\n      totalGeneration += option.annualGeneration || 0;\n      totalSavings += option.annualCostSavings || 0;\n      totalExportRevenue += option.annualExportRevenue || 0;\n      totalCO2Savings += option.annualTotalCO2Savings || 0;\n\n      // Aggregate monthly data\n      if (option.monthlyGeneration) {\n        option.monthlyGeneration.forEach((value, index) => {\n          monthlyGeneration[index] += value || 0;\n        });\n      }\n      if (option.monthlyCostSavings) {\n        option.monthlyCostSavings.forEach((value, index) => {\n          monthlySavings[index] += value || 0;\n        });\n      }\n      if (option.monthlyExportRevenue) {\n        option.monthlyExportRevenue.forEach((value, index) => {\n          monthlyExportRevenue[index] += value || 0;\n        });\n      }\n      if (option.monthlyDirectCO2Savings && option.monthlyIndirectCO2Savings) {\n        option.monthlyDirectCO2Savings.forEach((direct, index) => {\n          const indirect = option.monthlyIndirectCO2Savings[index] || 0;\n          monthlyCO2Savings[index] += (direct || 0) + indirect;\n        });\n      }\n    });\n\n    const paybackPeriod = (totalSavings + totalExportRevenue) > 0 ? \n      totalCost / (totalSavings + totalExportRevenue) : 999;\n\n    return {\n      installationCost: totalCost,\n      annualGeneration: totalGeneration,\n      annualSavings: totalSavings,\n      annualExportRevenue: totalExportRevenue,\n      annualCO2Savings: totalCO2Savings,\n      paybackPeriod: paybackPeriod,\n      monthlyData: {\n        generation: monthlyGeneration,\n        savings: monthlySavings,\n        exportRevenue: monthlyExportRevenue,\n        co2Savings: monthlyCO2Savings\n      }\n    };\n  };\n\n  const addConfiguration = () => {\n    const newId = Math.max(...configurations.map(c => c.id)) + 1;\n    setConfigurations(prev => [...prev, createEmptyConfiguration(newId)]);\n  };\n\n  const removeConfiguration = (configId) => {\n    if (configurations.length > 1) {\n      setConfigurations(prev => prev.filter(c => c.id !== configId));\n    }\n  };\n\n  const showMonthlyChart = (config, dataType, title) => {\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', \n                   'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    \n    let monthlyData = [];\n    switch (dataType) {\n      case 'generation':\n        monthlyData = config.calculations.monthlyData.generation;\n        break;\n      case 'savings':\n        monthlyData = config.calculations.monthlyData.savings;\n        break;\n      case 'exportRevenue':\n        monthlyData = config.calculations.monthlyData.exportRevenue;\n        break;\n      case 'co2Savings':\n        monthlyData = config.calculations.monthlyData.co2Savings;\n        break;\n      default:\n        monthlyData = [];\n    }\n\n    const chartData = {\n      labels: months,\n      datasets: [{\n        label: title,\n        data: monthlyData,\n        borderColor: getChartColor(dataType),\n        backgroundColor: getChartColor(dataType) + '20',\n        tension: 0.4,\n        fill: true\n      }]\n    };\n\n    const chartOptions = {\n      responsive: true,\n      plugins: {\n        legend: { position: 'top' },\n        title: { display: true, text: `${config.name} - ${title}` }\n      },\n      scales: {\n        y: { beginAtZero: true }\n      }\n    };\n\n    setShowChart({\n      visible: true,\n      data: chartData,\n      options: chartOptions,\n      title: `${config.name} - ${title}`\n    });\n  };\n\n  const getChartColor = (dataType) => {\n    const colors = {\n      generation: '#3498db',\n      savings: '#27ae60',\n      exportRevenue: '#f39c12',\n      co2Savings: '#e74c3c'\n    };\n    return colors[dataType] || '#34495e';\n  };\n\n  const formatCurrency = (value) => {\n    return value ? `£${Math.round(value).toLocaleString()}` : '£0';\n  };\n\n  const formatNumber = (value, unit = '') => {\n    return value ? `${Math.round(value).toLocaleString()}${unit}` : `0${unit}`;\n  };\n\n  const getEquipmentName = (equipmentType, equipmentId) => {\n    if (!equipmentId || !availableEquipment[equipmentType]) return '';\n    const equipment = availableEquipment[equipmentType].find(e => e.id == equipmentId);\n    return equipment ? equipment.name : '';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"configuration-comparison-loading\">\n        <h3>Loading Equipment Options...</h3>\n        <p>Generating recommended configurations for you.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"configuration-comparison\">\n      <div className=\"comparison-header\">\n        <h3>System Configuration Comparison</h3>\n        <p>Here are our recommended configurations. You can modify them or add your own.</p>\n      </div>\n\n      <div className=\"configuration-table-container\">\n        <table className=\"configuration-table\">\n          <thead>\n            <tr>\n              <th>Configuration Name</th>\n              {selectedEquipment.solarPanels && <th>Solar Panels</th>}\n              {selectedEquipment.heatPump && <th>Heat Pump</th>}\n              {selectedEquipment.batteryStorage && <th>Battery Storage</th>}\n              <th>Installation Cost</th>\n              <th className=\"clickable-header\" title=\"Click to view monthly chart\">Annual Generation</th>\n              <th className=\"clickable-header\" title=\"Click to view monthly chart\">Annual Savings</th>\n              <th className=\"clickable-header\" title=\"Click to view monthly chart\">Export Revenue</th>\n              <th className=\"clickable-header\" title=\"Click to view monthly chart\">CO₂ Savings</th>\n              <th>Payback Period</th>\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {configurations.map(config => (\n              <tr key={config.id} className={config.loading ? 'loading-row' : ''}>\n                <td>\n                  <input \n                    type=\"text\" \n                    value={config.name}\n                    onChange={(e) => {\n                      setConfigurations(prev => prev.map(c => \n                        c.id === config.id ? { ...c, name: e.target.value } : c\n                      ));\n                    }}\n                    className=\"config-name-input\"\n                  />\n                </td>\n                \n                {selectedEquipment.solarPanels && (\n                  <td>\n                    <select \n                      value={config.selections.solar || ''}\n                      onChange={(e) => handleEquipmentChange(config.id, 'solar', e.target.value)}\n                      className=\"equipment-select\"\n                    >\n                      <option value=\"\">Please select...</option>\n                      {availableEquipment.solar?.map(panel => (\n                        <option key={panel.id} value={panel.id}>\n                          {panel.name} ({panel.ratedPowerPerPanel}W)\n                        </option>\n                      ))}\n                    </select>\n                  </td>\n                )}\n                \n                {selectedEquipment.heatPump && (\n                  <td>\n                    <select \n                      value={config.selections.heatPump || ''}\n                      onChange={(e) => handleEquipmentChange(config.id, 'heatPump', e.target.value)}\n                      className=\"equipment-select\"\n                    >\n                      <option value=\"\">Please select...</option>\n                      {availableEquipment.heatPump?.map(heatPump => (\n                        <option key={heatPump.id} value={heatPump.id}>\n                          {heatPump.name} (COP: {heatPump.cop})\n                        </option>\n                      ))}\n                    </select>\n                  </td>\n                )}\n                \n                {selectedEquipment.batteryStorage && (\n                  <td>\n                    <select \n                      value={config.selections.battery || ''}\n                      onChange={(e) => handleEquipmentChange(config.id, 'battery', e.target.value)}\n                      className=\"equipment-select\"\n                    >\n                      <option value=\"\">Please select...</option>\n                      {availableEquipment.battery?.map(battery => (\n                        <option key={battery.id} value={battery.id}>\n                          {battery.name} ({battery.capacityKwh}kWh)\n                        </option>\n                      ))}\n                    </select>\n                  </td>\n                )}\n                \n                <td>{config.loading ? 'Calculating...' : formatCurrency(config.calculations.installationCost)}</td>\n                \n                <td \n                  className=\"clickable-cell\"\n                  onClick={() => !config.loading && showMonthlyChart(config, 'generation', 'Monthly Generation (kWh)')}\n                >\n                  {config.loading ? 'Calculating...' : formatNumber(config.calculations.annualGeneration, ' kWh')}\n                </td>\n                \n                <td \n                  className=\"clickable-cell\"\n                  onClick={() => !config.loading && showMonthlyChart(config, 'savings', 'Monthly Savings (£)')}\n                >\n                  {config.loading ? 'Calculating...' : formatCurrency(config.calculations.annualSavings)}\n                </td>\n                \n                <td \n                  className=\"clickable-cell\"\n                  onClick={() => !config.loading && showMonthlyChart(config, 'exportRevenue', 'Monthly Export Revenue (£)')}\n                >\n                  {config.loading ? 'Calculating...' : formatCurrency(config.calculations.annualExportRevenue)}\n                </td>\n                \n                <td \n                  className=\"clickable-cell\"\n                  onClick={() => !config.loading && showMonthlyChart(config, 'co2Savings', 'Monthly CO₂ Savings (kg)')}\n                >\n                  {config.loading ? 'Calculating...' : formatNumber(config.calculations.annualCO2Savings, ' kg')}\n                </td>\n                \n                <td>{config.loading ? 'Calculating...' : formatNumber(config.calculations.paybackPeriod, ' years')}</td>\n                \n                <td>\n                  <button \n                    className=\"btn-remove\" \n                    onClick={() => removeConfiguration(config.id)}\n                    disabled={configurations.length <= 1}\n                    title=\"Remove configuration\"\n                  >\n                    ×\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"table-actions\">\n        <button className=\"btn btn-secondary\" onClick={addConfiguration}>\n          + Add Custom Configuration\n        </button>\n        <span className=\"table-hint\">\n          💡 The first 3 are our recommendations. Modify them or add your own configurations.\n        </span>\n      </div>\n\n      {/* Monthly Chart Modal */}\n      {showChart.visible && (\n        <div className=\"chart-modal-overlay\" onClick={() => setShowChart({ visible: false, data: null, title: '' })}>\n          <div className=\"chart-modal\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"chart-modal-header\">\n              <h4>{showChart.title}</h4>\n              <button \n                className=\"chart-close-button\"\n                onClick={() => setShowChart({ visible: false, data: null, title: '' })}\n              >\n                ×\n              </button>\n            </div>\n            <div className=\"chart-container\">\n              <Line data={showChart.data} options={showChart.options} />\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"comparison-actions\">\n        <button className=\"btn btn-secondary\" onClick={onBack}>\n          Back to Equipment Selection\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default ConfigurationComparison; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}