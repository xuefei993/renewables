{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import EnergyDemandChart from\"../EnergyDemandChart\";import SolarPotentialSummary from\"./SolarPotentialSummary\";import SystemConfiguration from\"./SystemConfiguration\";import SubsidyChecker from\"../SubsidyChecker\";import{prepareUserData}from\"./resultsUtils\";import\"../../styles/energy-demand.css\";import\"../../styles/results.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Results=_ref=>{var _data$addedRoofs;let{data,calculationResult,setCalculationResult,onBack}=_ref;const[loading,setLoading]=useState(true);const[activeTab,setActiveTab]=useState('summary');// 'summary' or 'configuration'\nconst[systemConfiguration,setSystemConfiguration]=useState({});const[appliedSubsidies,setAppliedSubsidies]=useState([]);const[totalSubsidyAmount,setTotalSubsidyAmount]=useState(0);const[showComparison,setShowComparison]=useState(false);// Tab switching handler\nconst handleTabChange=tab=>{setActiveTab(tab);};// Handle subsidy application/removal\nconst handleSubsidyApplied=(subsidies,totalAmount)=>{setAppliedSubsidies(subsidies);setTotalSubsidyAmount(totalAmount);// Here you could update the configuration comparison table\n// to reflect the subsidy amounts being deducted from installation costs\nconsole.log('Applied subsidies updated:',subsidies);console.log('Total subsidy amount:',totalAmount);};// Listen for system configuration updates from SystemConfiguration component\nconst handleSystemConfigurationUpdate=config=>{setSystemConfiguration(config);// Update showComparison state if provided\nif(config.showComparison!==undefined){setShowComparison(config.showComparison);}};useEffect(()=>{if(data){setLoading(false);}},[data]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"results-loading\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading results...\"})});}if(!data){return/*#__PURE__*/_jsx(\"div\",{className:\"results-error\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No data available for results.\"})});}const selectedRoofs=data.selectedRoofs||((_data$addedRoofs=data.addedRoofs)===null||_data$addedRoofs===void 0?void 0:_data$addedRoofs.filter(roof=>roof.selected))||[];const userData=prepareUserData(data);console.log('Results data:',data);// Debug log\nconsole.log('Selected roofs:',selectedRoofs);// Debug log\nconsole.log('User data for energy demand:',userData);// Debug log\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"results-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Renewable Energy System Results\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"tab-button \".concat(activeTab==='summary'?'active':''),onClick:()=>handleTabChange('summary'),children:\"Property Summary\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tab-button \".concat(activeTab==='configuration'?'active':''),onClick:()=>handleTabChange('configuration'),children:\"System Configuration\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[activeTab==='summary'&&/*#__PURE__*/_jsxs(\"div\",{className:\"property-summary-tab\",children:[/*#__PURE__*/_jsx(SolarPotentialSummary,{selectedRoofs:selectedRoofs}),/*#__PURE__*/_jsx(\"div\",{className:\"results-section energy-demand-section\",children:/*#__PURE__*/_jsx(EnergyDemandChart,{userData:userData})})]}),activeTab==='configuration'&&/*#__PURE__*/_jsxs(\"div\",{className:\"system-configuration-tab\",children:[/*#__PURE__*/_jsx(SystemConfiguration,{userData:userData,onConfigurationUpdate:handleSystemConfigurationUpdate,appliedSubsidies:appliedSubsidies,totalSubsidyAmount:totalSubsidyAmount}),showComparison&&/*#__PURE__*/_jsx(SubsidyChecker,{userData:userData,systemConfiguration:systemConfiguration,onSubsidyApplied:handleSubsidyApplied})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"button-group\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:onBack,children:\"Back to Tariffs\"})})]});};export default Results;","map":{"version":3,"names":["React","useEffect","useState","EnergyDemandChart","SolarPotentialSummary","SystemConfiguration","SubsidyChecker","prepareUserData","jsx","_jsx","jsxs","_jsxs","Results","_ref","_data$addedRoofs","data","calculationResult","setCalculationResult","onBack","loading","setLoading","activeTab","setActiveTab","systemConfiguration","setSystemConfiguration","appliedSubsidies","setAppliedSubsidies","totalSubsidyAmount","setTotalSubsidyAmount","showComparison","setShowComparison","handleTabChange","tab","handleSubsidyApplied","subsidies","totalAmount","console","log","handleSystemConfigurationUpdate","config","undefined","className","children","selectedRoofs","addedRoofs","filter","roof","selected","userData","concat","onClick","onConfigurationUpdate","onSubsidyApplied","type"],"sources":["/Users/xuefei/renewables/calculator/renewableCalculator.ui/src/components/steps/Results.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport EnergyDemandChart from \"../EnergyDemandChart\";\nimport SolarPotentialSummary from \"./SolarPotentialSummary\";\nimport SystemConfiguration from \"./SystemConfiguration\";\nimport SubsidyChecker from \"../SubsidyChecker\";\nimport { prepareUserData } from \"./resultsUtils\";\nimport \"../../styles/energy-demand.css\";\nimport \"../../styles/results.css\";\n\nconst Results = ({ data, calculationResult, setCalculationResult, onBack }) => {\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState('summary'); // 'summary' or 'configuration'\n  const [systemConfiguration, setSystemConfiguration] = useState({});\n  const [appliedSubsidies, setAppliedSubsidies] = useState([]);\n  const [totalSubsidyAmount, setTotalSubsidyAmount] = useState(0);\n  const [showComparison, setShowComparison] = useState(false);\n\n  // Tab switching handler\n  const handleTabChange = (tab) => {\n    setActiveTab(tab);\n  };\n\n  // Handle subsidy application/removal\n  const handleSubsidyApplied = (subsidies, totalAmount) => {\n    setAppliedSubsidies(subsidies);\n    setTotalSubsidyAmount(totalAmount);\n    \n    // Here you could update the configuration comparison table\n    // to reflect the subsidy amounts being deducted from installation costs\n    console.log('Applied subsidies updated:', subsidies);\n    console.log('Total subsidy amount:', totalAmount);\n  };\n\n  // Listen for system configuration updates from SystemConfiguration component\n  const handleSystemConfigurationUpdate = (config) => {\n    setSystemConfiguration(config);\n    \n    // Update showComparison state if provided\n    if (config.showComparison !== undefined) {\n      setShowComparison(config.showComparison);\n    }\n  };\n\n  useEffect(() => {\n    if (data) {\n      setLoading(false);\n    }\n  }, [data]);\n\n  if (loading) {\n    return (\n      <div className=\"results-loading\">\n        <p>Loading results...</p>\n      </div>\n    );\n  }\n\n  if (!data) {\n    return (\n      <div className=\"results-error\">\n        <p>No data available for results.</p>\n      </div>\n    );\n  }\n\n  const selectedRoofs = data.selectedRoofs || data.addedRoofs?.filter(roof => roof.selected) || [];\n  const userData = prepareUserData(data);\n\n  console.log('Results data:', data); // Debug log\n  console.log('Selected roofs:', selectedRoofs); // Debug log\n  console.log('User data for energy demand:', userData); // Debug log\n\n  return (\n    <div className=\"results-container\">\n      <h2>Renewable Energy System Results</h2>\n\n      {/* Tab Navigation */}\n      <div className=\"results-tabs\">\n        <button\n          className={`tab-button ${activeTab === 'summary' ? 'active' : ''}`}\n          onClick={() => handleTabChange('summary')}\n        >\n          Property Summary\n        </button>\n        <button\n          className={`tab-button ${activeTab === 'configuration' ? 'active' : ''}`}\n          onClick={() => handleTabChange('configuration')}\n        >\n          System Configuration\n        </button>\n      </div>\n\n      {/* Tab Content */}\n      <div className=\"tab-content\">\n\n        {/* Property Summary Tab */}\n        {activeTab === 'summary' && (\n          <div className=\"property-summary-tab\">\n            <SolarPotentialSummary selectedRoofs={selectedRoofs} />\n            {/* Energy Demand Section */}\n            <div className=\"results-section energy-demand-section\">\n              <EnergyDemandChart userData={userData} />\n            </div>\n          </div>\n        )}\n\n        {/* System Configuration Tab */}\n        {activeTab === 'configuration' && (\n          <div className=\"system-configuration-tab\">\n            <SystemConfiguration \n              userData={userData} \n              onConfigurationUpdate={handleSystemConfigurationUpdate}\n              appliedSubsidies={appliedSubsidies}\n              totalSubsidyAmount={totalSubsidyAmount}\n            />\n            \n            {/* Subsidy Checker */}\n            {showComparison && (\n              <SubsidyChecker \n                userData={userData}\n                systemConfiguration={systemConfiguration}\n                onSubsidyApplied={handleSubsidyApplied}\n              />\n            )}\n          </div>\n        )}\n\n      </div>\n\n      <div className=\"button-group\">\n        <button type=\"button\" className=\"btn btn-secondary\" onClick={onBack}>\n          Back to Tariffs\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Results; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,iBAAiB,KAAM,sBAAsB,CACpD,MAAO,CAAAC,qBAAqB,KAAM,yBAAyB,CAC3D,MAAO,CAAAC,mBAAmB,KAAM,uBAAuB,CACvD,MAAO,CAAAC,cAAc,KAAM,mBAAmB,CAC9C,OAASC,eAAe,KAAQ,gBAAgB,CAChD,MAAO,gCAAgC,CACvC,MAAO,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAElC,KAAM,CAAAC,OAAO,CAAGC,IAAA,EAA+D,KAAAC,gBAAA,IAA9D,CAAEC,IAAI,CAAEC,iBAAiB,CAAEC,oBAAoB,CAAEC,MAAO,CAAC,CAAAL,IAAA,CACxE,KAAM,CAACM,OAAO,CAAEC,UAAU,CAAC,CAAGlB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACmB,SAAS,CAAEC,YAAY,CAAC,CAAGpB,QAAQ,CAAC,SAAS,CAAC,CAAE;AACvD,KAAM,CAACqB,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGtB,QAAQ,CAAC,CAAC,CAAC,CAAC,CAClE,KAAM,CAACuB,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAACyB,kBAAkB,CAAEC,qBAAqB,CAAC,CAAG1B,QAAQ,CAAC,CAAC,CAAC,CAC/D,KAAM,CAAC2B,cAAc,CAAEC,iBAAiB,CAAC,CAAG5B,QAAQ,CAAC,KAAK,CAAC,CAE3D;AACA,KAAM,CAAA6B,eAAe,CAAIC,GAAG,EAAK,CAC/BV,YAAY,CAACU,GAAG,CAAC,CACnB,CAAC,CAED;AACA,KAAM,CAAAC,oBAAoB,CAAGA,CAACC,SAAS,CAAEC,WAAW,GAAK,CACvDT,mBAAmB,CAACQ,SAAS,CAAC,CAC9BN,qBAAqB,CAACO,WAAW,CAAC,CAElC;AACA;AACAC,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEH,SAAS,CAAC,CACpDE,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAEF,WAAW,CAAC,CACnD,CAAC,CAED;AACA,KAAM,CAAAG,+BAA+B,CAAIC,MAAM,EAAK,CAClDf,sBAAsB,CAACe,MAAM,CAAC,CAE9B;AACA,GAAIA,MAAM,CAACV,cAAc,GAAKW,SAAS,CAAE,CACvCV,iBAAiB,CAACS,MAAM,CAACV,cAAc,CAAC,CAC1C,CACF,CAAC,CAED5B,SAAS,CAAC,IAAM,CACd,GAAIc,IAAI,CAAE,CACRK,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,CAACL,IAAI,CAAC,CAAC,CAEV,GAAII,OAAO,CAAE,CACX,mBACEV,IAAA,QAAKgC,SAAS,CAAC,iBAAiB,CAAAC,QAAA,cAC9BjC,IAAA,MAAAiC,QAAA,CAAG,oBAAkB,CAAG,CAAC,CACtB,CAAC,CAEV,CAEA,GAAI,CAAC3B,IAAI,CAAE,CACT,mBACEN,IAAA,QAAKgC,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BjC,IAAA,MAAAiC,QAAA,CAAG,gCAA8B,CAAG,CAAC,CAClC,CAAC,CAEV,CAEA,KAAM,CAAAC,aAAa,CAAG5B,IAAI,CAAC4B,aAAa,IAAA7B,gBAAA,CAAIC,IAAI,CAAC6B,UAAU,UAAA9B,gBAAA,iBAAfA,gBAAA,CAAiB+B,MAAM,CAACC,IAAI,EAAIA,IAAI,CAACC,QAAQ,CAAC,GAAI,EAAE,CAChG,KAAM,CAAAC,QAAQ,CAAGzC,eAAe,CAACQ,IAAI,CAAC,CAEtCqB,OAAO,CAACC,GAAG,CAAC,eAAe,CAAEtB,IAAI,CAAC,CAAE;AACpCqB,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEM,aAAa,CAAC,CAAE;AAC/CP,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAEW,QAAQ,CAAC,CAAE;AAEvD,mBACErC,KAAA,QAAK8B,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCjC,IAAA,OAAAiC,QAAA,CAAI,iCAA+B,CAAI,CAAC,cAGxC/B,KAAA,QAAK8B,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BjC,IAAA,WACEgC,SAAS,eAAAQ,MAAA,CAAgB5B,SAAS,GAAK,SAAS,CAAG,QAAQ,CAAG,EAAE,CAAG,CACnE6B,OAAO,CAAEA,CAAA,GAAMnB,eAAe,CAAC,SAAS,CAAE,CAAAW,QAAA,CAC3C,kBAED,CAAQ,CAAC,cACTjC,IAAA,WACEgC,SAAS,eAAAQ,MAAA,CAAgB5B,SAAS,GAAK,eAAe,CAAG,QAAQ,CAAG,EAAE,CAAG,CACzE6B,OAAO,CAAEA,CAAA,GAAMnB,eAAe,CAAC,eAAe,CAAE,CAAAW,QAAA,CACjD,sBAED,CAAQ,CAAC,EACN,CAAC,cAGN/B,KAAA,QAAK8B,SAAS,CAAC,aAAa,CAAAC,QAAA,EAGzBrB,SAAS,GAAK,SAAS,eACtBV,KAAA,QAAK8B,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnCjC,IAAA,CAACL,qBAAqB,EAACuC,aAAa,CAAEA,aAAc,CAAE,CAAC,cAEvDlC,IAAA,QAAKgC,SAAS,CAAC,uCAAuC,CAAAC,QAAA,cACpDjC,IAAA,CAACN,iBAAiB,EAAC6C,QAAQ,CAAEA,QAAS,CAAE,CAAC,CACtC,CAAC,EACH,CACN,CAGA3B,SAAS,GAAK,eAAe,eAC5BV,KAAA,QAAK8B,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvCjC,IAAA,CAACJ,mBAAmB,EAClB2C,QAAQ,CAAEA,QAAS,CACnBG,qBAAqB,CAAEb,+BAAgC,CACvDb,gBAAgB,CAAEA,gBAAiB,CACnCE,kBAAkB,CAAEA,kBAAmB,CACxC,CAAC,CAGDE,cAAc,eACbpB,IAAA,CAACH,cAAc,EACb0C,QAAQ,CAAEA,QAAS,CACnBzB,mBAAmB,CAAEA,mBAAoB,CACzC6B,gBAAgB,CAAEnB,oBAAqB,CACxC,CACF,EACE,CACN,EAEE,CAAC,cAENxB,IAAA,QAAKgC,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BjC,IAAA,WAAQ4C,IAAI,CAAC,QAAQ,CAACZ,SAAS,CAAC,mBAAmB,CAACS,OAAO,CAAEhC,MAAO,CAAAwB,QAAA,CAAC,iBAErE,CAAQ,CAAC,CACN,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAA9B,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}