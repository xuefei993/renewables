# 系统配置方案对比功能使用指南

## 功能概览

全新的**系统配置方案对比**功能允许用户自由搭配不同品牌的可再生能源设备，实时查看每个方案的性能数据。这是一个类似"配置器"的界面，用户可以创建多个方案进行全面对比。

## 🎯 核心特性

### 📋 动态对比表格
- **前几列**: 根据用户选择的设备类型显示相应的品牌选择下拉框
- **实时计算**: 用户选择设备后，右侧数据列自动更新
- **多方案对比**: 支持同时创建和对比多个配置方案
- **月度图表**: 点击数据单元格查看详细的月度趋势图

### 🔧 灵活配置
- **设备类型选择**: 太阳能板、热泵、蓄电池
- **品牌自由搭配**: 每个方案可选择不同品牌组合
- **方案管理**: 添加、删除、重命名配置方案
- **实时反馈**: 选择改变即刻显示计算结果

## 📊 数据展示

### 表格列结构
```
方案名称 | 太阳能板 | 热泵 | 蓄电池 | 安装成本 | 全年发电量📊 | 全年节省📊 | 卖电收入📊 | CO₂节省📊 | 投资回本期 | 操作
```

### 实时计算数据
- **安装成本**: 包含设备和安装费用
- **全年发电量**: 年度电力生产总量 (kWh)
- **全年节省**: 年度成本节省总额 (£)
- **卖电收入**: 年度电力出售收入 (£)
- **CO₂节省**: 年度碳排放减少量 (kg)
- **投资回本期**: 简单投资回收期 (年)

## 🚀 使用流程

### 1. 设备类型选择
```javascript
// 用户首先选择要安装的设备类型
const selectedEquipment = {
  solarPanels: true,      // 选择太阳能板
  heatPump: true,         // 选择热泵
  batteryStorage: false   // 不选择蓄电池
};
```

### 2. 进入配置表格
确认设备类型后，系统显示动态对比表格，包含相应的设备选择列。

### 3. 方案配置
```
方案 1: JA Solar 545W + Mitsubishi 8kW
方案 2: LG NeON 380W + Daikin 10kW  
方案 3: Canadian Solar 400W + Samsung 12kW
```

### 4. 实时数据更新
每当用户在下拉框中选择不同设备，对应行的性能数据立即重新计算。

### 5. 深度分析
点击任何数据单元格，弹出月度趋势图进行详细分析。

## 🛠️ 技术实现

### 前端组件架构
```
SystemConfiguration.js
├── ConfigurationComparison.js
│   ├── 设备选择下拉框
│   ├── 实时计算逻辑
│   ├── 月度图表模态窗口
│   └── 方案管理功能
└── configuration-comparison.css
```

### 后端API集成
```javascript
// 1. 加载可用设备
GET /api/equipment/solar-panels/available
GET /api/equipment/heat-pumps/available  
GET /api/equipment/batteries/available

// 2. 实时性能计算
POST /api/equipment/compare
{
  "solarPanelTypeIds": [1],
  "heatPumpTypeIds": [2],
  "batteryIds": [],
  // ... 用户房屋数据
}
```

### 实时计算流程
```javascript
handleEquipmentChange(configId, equipmentType, equipmentId)
  ↓
setLoading(true) // 显示"计算中..."
  ↓ 
recalculateConfiguration() // 调用后端API
  ↓
processCalculationResult() // 处理返回数据
  ↓
updateConfigurations() // 更新界面显示
```

## 💡 用户体验设计

### 视觉反馈
- **加载状态**: 选择改变时显示"计算中..."
- **hover效果**: 鼠标悬停突出显示可点击元素
- **数据高亮**: 重要数值用颜色区分（绿色=好，橙色=中等，红色=差）

### 交互设计
- **表格行hover**: 整行高亮显示
- **下拉框联动**: 选择改变触发计算
- **图表弹窗**: 点击数据查看月度趋势
- **响应式布局**: 支持桌面和移动设备

### 用户引导
```
💡 选择设备后数据会自动计算，点击数据列可查看月度趋势图
```

## 📈 示例使用场景

### 场景1: 太阳能板品牌对比
用户想比较不同太阳能板品牌：
```
方案1: JA Solar 545W     → 4,250 kWh/年, £1,275节省, 5.4年回本
方案2: LG NeON 380W      → 3,800 kWh/年, £1,140节省, 6.1年回本  
方案3: Canadian Solar    → 4,100 kWh/年, £1,230节省, 5.8年回本
```

### 场景2: 系统组合优化
用户测试不同设备组合：
```
方案1: 仅太阳能板      → £1,275/年节省, 5.4年回本
方案2: 太阳能+蓄电池   → £1,520/年节省, 6.8年回本
方案3: 太阳能+热泵     → £2,010/年节省, 8.2年回本
方案4: 全套系统       → £2,350/年节省, 9.1年回本
```

### 场景3: 预算方案对比
不同预算下的最优选择：
```
经济型方案: 基础太阳能板 → £6,500安装, £1,100/年节省
标准型方案: 高效太阳能板 → £8,500安装, £1,275/年节省  
豪华型方案: 全套智能系统 → £18,000安装, £2,350/年节省
```

## 🔍 月度图表功能

### 可视化数据类型
- **发电量图表**: 展示季节性发电变化
- **节省图表**: 显示月度成本节省波动
- **收入图表**: 卖电收入的季节性变化
- **环保图表**: 月度CO₂减排效果

### 图表交互
```javascript
// 点击表格单元格触发
showMonthlyChart(config, 'generation', '月度发电量 (kWh)')
  ↓
显示12个月的折线图
  ↓
用户可以：
- 查看具体数值
- 分析季节性模式
- 对比不同月份表现
```

## 🎨 界面预览

### 主要界面布局
```
┌─────────────────────────────────────────────────────────────────┐
│                    系统配置方案对比                              │
├─────────────────────────────────────────────────────────────────┤
│ 方案名称 │ 太阳能板▼   │ 热泵▼      │ 安装成本  │ 发电量📊 │ 节省📊 │
├─────────────────────────────────────────────────────────────────┤
│ 方案 1   │ JA Solar    │ Mitsubishi │ £15,500  │ 4,250   │ £1,275│
│ 方案 2   │ LG NeON     │ Daikin     │ £16,200  │ 3,800   │ £1,140│
│ 方案 3   │ [请选择...] │ [请选择...] │ 计算中... │ 计算中... │ 计算中... │
├─────────────────────────────────────────────────────────────────┤
│                    + 添加新方案                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 移动端适配
- 横向滚动表格
- 紧凑的下拉框设计
- 触摸友好的图表模态窗口

## 🔧 开发指南

### 添加新设备类型
1. 更新`selectedEquipment`状态结构
2. 在表格中添加对应列
3. 更新设备加载逻辑
4. 扩展计算请求格式

### 自定义计算逻辑
```javascript
// 在processCalculationResult中添加新的聚合逻辑
const processCalculationResult = (result) => {
  // 聚合所有设备类型的数据
  let totalCost = 0;
  let totalGeneration = 0;
  // ... 自定义计算逻辑
};
```

### 扩展图表类型
```javascript
// 添加新的图表数据类型
case 'newDataType':
  monthlyData = config.calculations.monthlyData.newType;
  break;
```

## 🚀 部署和使用

### 启动后端服务
```bash
cd renewableCalculator.backend
mvn spring-boot:run
```

### 启动前端服务
```bash
cd renewableCalculator.ui  
npm start
```

### 访问功能
1. 完成前面的步骤（地址、房屋信息等）
2. 进入"Results"页面
3. 切换到"System Configuration"标签页
4. 选择设备类型，开始配置对比

## 🎯 未来扩展

### 计划功能
- **智能推荐**: AI驱动的最优方案推荐
- **成本分析**: 详细的成本分解和融资选项
- **性能预测**: 基于历史数据的性能预测
- **社区对比**: 与附近用户的方案对比

### 技术优化
- **性能缓存**: 常用配置的结果缓存
- **批量计算**: 多方案并行计算优化
- **实时更新**: WebSocket实时数据推送
- **离线模式**: 基本功能的离线支持

这个配置对比功能为用户提供了前所未有的灵活性和透明度，帮助他们根据具体需求和预算做出最明智的可再生能源投资决策！🌟 